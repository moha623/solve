<!-- <ngx-spinner bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#fff" type="square-jelly-box" [fullScreen]="true">
  <p style="color: white"> Loading... </p>
</ngx-spinner> -->

<section class="relative min-h-screen flex flex-col justify-between overflow-hidden">
  <!-- Background with overlay -->

  <div class="absolute inset-0 z-0">
    <img
      src="https://images.unsplash.com/photo-1598300042247-d088f8ab3a91?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1600&q=80"
      alt="Modern Furniture"
      class="w-full h-full object-cover"
    />
    <div class="absolute inset-0 hero-overlay"></div>
  </div>
  <nav class="relative z-50 py-6 px-4 md:px-8">
    <div class="container mx-auto">
      <div class="flex justify-between items-center">
        <!-- Logo -->
        <div class="flex items-center">
          <span  class="text-4xl font-bold text-white heading-font">Promomag</span>
        </div>

        <!-- Desktop Navigation -->
        <div class="  md:flex space-x-8">
          <!-- <a class="text-white nav-link ml-4">الرئيسية</a>
          <a href="#product" class="text-white nav-link">منتجاتنا</a>
          <a
            (click)="openWhatsApp()"
            class="text-white nav-link bg-transparent border-none cursor-pointer p-0"
          >
            اتصل بنا
          </a> -->
     
            <div class="menu-btn-container" id="menu-btn" (click)="toggleMobileMenu()" aria-label="Toggle menu">
              <span class="text-2xl font-bold text-center flex flex-col items-center button-menu">
                <div class="menu-line"></div>
                <div class="menu-line"></div>
              </span>
            </div>
         
        </div>

        <!-- Navigation Icons -->
        <div class="flex items-center space-x-6 space-x-reverse">
          <!-- <a class="text-white hover:text-accent flex items-center gap-2">
            <span class="text-white font-medium hidden md:inline-block">عربة التسوق</span>
            <div class="relative">
              <i class="fas fa-shopping-cart text-xl"></i>
            </div>
          </a> -->
          <a routerLink="/login" class="text-white hover:text-accent flex items-center gap-2">
            <span class="text-white font-medium hidden md:inline-block">حسابي</span>
            <i class="fas fa-user text-xl"></i>
          </a>

          <!-- Mobile menu button -->
          <!-- <button class="text-white" (click)="toggleMobileMenu()" aria-label="Toggle menu">
            <i *ngIf="!isMobileMenuActive" class="fas fa-bars text-2xl"></i>
            <i *ngIf="isMobileMenuActive" class="fas fa-times text-2xl"></i>
          </button> -->
        </div>
      </div>

      <!-- Mobile Circular Menu -->
      <div class="fixed inset-0 z-40 overflow-hidden" *ngIf="isMobileMenuActive">
        <div class="absolute inset-0 bg-gray-900 opacity-75" (click)="toggleMobileMenu()"></div>
        <div class="absolute inset-0 flex items-center justify-center">
          <div class="relative w-64 h-64">
            <!-- Circular menu items -->
            <a
              class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-full w-14 h-14 flex items-center justify-center transition-all duration-300 hover:bg-accent hover:text-white"
              (click)="navigateTo('home')"
            >
              <i class="fas fa-home text-xl"></i>
            </a>

            <a
              href="#product"
              class="absolute top-1/4 right-0 transform translate-x-1/2 -translate-y-1/2 bg-white rounded-full w-14 h-14 flex items-center justify-center transition-all duration-300 hover:bg-accent hover:text-white"
              
            >
              <i class="fas fa-box text-xl"></i>
            </a>

            <a
              class="absolute bottom-1/4 right-0 transform translate-x-1/2 translate-y-1/2 bg-white rounded-full w-14 h-14 flex items-center justify-center transition-all duration-300 hover:bg-accent hover:text-white"
              (click)="openWhatsApp()"
            >
              <i class="fas fa-phone text-xl"></i>
            </a>

            <a
              class="absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-1/2 bg-white rounded-full w-14 h-14 flex items-center justify-center transition-all duration-300 hover:bg-accent hover:text-white"
          href="#product"
            >
              <i class="fas fa-shopping-cart text-xl"></i>
            </a>

            <a
              class="absolute bottom-1/4 left-0 transform -translate-x-1/2 translate-y-1/2 bg-white rounded-full w-14 h-14 flex items-center justify-center transition-all duration-300 hover:bg-accent hover:text-white"
              routerLink="/login"
            >
              <i class="fas fa-user text-xl"></i>
            </a>

            <a
              class="absolute top-1/4 left-0 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-full w-14 h-14 flex items-center justify-center transition-all duration-300 hover:bg-accent hover:text-white"
              (click)="toggleMobileMenu()"
            >
              <i class="fas fa-times text-xl"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Content -->
  <div class="relative z-10 px-4 md:px-8 pb-16 pt-10 flex-grow flex items-center">
    <div class="container mx-auto">
      <div class="flex flex-col md:flex-row items-center justify-between">
        <div class="md:w-1/2 mb-12 md:mb-0 hero-content">
          <h1
            class="text-4xl md:text-5xl lg:text-6xl font-bold text-white heading-font mb-6 leading-tight"
          >
            حوّل مساحتك<br />بأناقة فائقة
          </h1>
          <p class="text-light text-xl mb-8 max-w-md">
            اكتشف أثاثًا يجمع بين الأناقة والراحة والوظائف لمنزلك. تصفح مجموعتنا المميزة من القطع
            المصممة بعناية.
          </p>
          <div class="flex flex-col sm:flex-row gap-4">
            <a
              class="cta-button bg-accent text-dark font-bold py-4 px-8 rounded-full text-lg"
              href="#product"
            >
              تسوق الآن <i class="fas fa-arrow-left mr-2"></i>
            </a>
            <button
              class="border-2 border-white text-white font-bold py-4 px-8 rounded-full text-lg hover:bg-accent hover:text-dark transition-colors"
            >
              اكتشف المزيد
            </button>
          </div>
        </div>

        <!-- Product Showcase -->
        <div class="md:w-2/5 grid grid-cols-2 gap-4">
          <div class="product-card bg-white rounded-2xl p-4 shadow-lg">
            <div class="h-40 mb-4 overflow-hidden rounded-xl">
              <img
                src="https://plus.unsplash.com/premium_photo-1678074057896-eee996d4a23e?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8OXx8aW1hZ2UlMjBjaGFpc2V8ZW58MHx8MHx8fDA%3D"
                alt="Modern Chair"
                class="w-full h-full object-cover"
              />
            </div>
            <h3 class="font-bold text-dark text-lg">كرسي مودرن</h3>
            <div class="flex justify-between items-center mt-2">
              <span class="text-accent font-bold">299 ر.س</span>
              <div class="flex text-yellow-400">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star-half-alt"></i>
              </div>
            </div>
          </div>

          <div class="product-card bg-white rounded-2xl p-4 shadow-lg">
            <div class="h-40 mb-4 overflow-hidden rounded-xl">
              <img
                src="https://images.unsplash.com/photo-1551298370-9d3d53740c72?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&q=80"
                alt="Wooden Table"
                class="w-full h-full object-cover"
              />
            </div>
            <h3 class="font-bold text-dark text-lg">طاولة خشبية</h3>
            <div class="flex justify-between items-center mt-2">
              <span class="text-accent font-bold">599 ر.س</span>
              <div class="flex text-yellow-400">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="far fa-star"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Features Bar -->
  <div class="relative z-10 bg-white py-4 shadow-inner">
    <div class="container mx-auto">
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="flex flex-col items-center text-center px-4">
          <div class="bg-primary rounded-full w-14 h-14 flex items-center justify-center mb-2">
            <i class="fas fa-truck text-white text-xl"></i>
          </div>
          <h3 class="font-bold text-dark">شحن مجاني</h3>
          <p class="text-sm text-gray-600">لطلبات فوق 500 ر.س</p>
        </div>

        <div class="flex flex-col items-center text-center px-4">
          <div class="bg-primary rounded-full w-14 h-14 flex items-center justify-center mb-2">
            <i class="fas fa-undo text-white text-xl"></i>
          </div>
          <h3 class="font-bold text-dark">إرجاع مجاني</h3>
          <p class="text-sm text-gray-600">ضمن 14 يوم من الشراء</p>
        </div>

        <div class="flex flex-col items-center text-center px-4">
          <div class="bg-primary rounded-full w-14 h-14 flex items-center justify-center mb-2">
            <i class="fas fa-shield-alt text-white text-xl"></i>
          </div>
          <h3 class="font-bold text-dark">ضمان الجودة</h3>
          <p class="text-sm text-gray-600">منتجات أصلية مضمونة</p>
        </div>

        <div class="flex flex-col items-center text-center px-4">
          <div class="bg-primary rounded-full w-14 h-14 flex items-center justify-center mb-2">
            <i class="fas fa-headset text-white text-xl"></i>
          </div>
          <h3 class="font-bold text-dark">دعم 24/7</h3>
          <p class="text-sm text-gray-600">خدمة عملاء على مدار الساعة</p>
        </div>
      </div>
    </div>
  </div>
</section>
 
<!-- Featured Products -->
<section class="py-16 bg-white product" id="product">
  <div class="container mx-auto px-4">
    <h2 class="text-3xl font-bold text-center text-blue-600 mb-12">المجموعة المميزة</h2>

    <div class="container mx-auto px-4 py-8">
      <h1 class="text-3xl font-bold text-center text-blue-700 mb-8">منتجاتنا</h1>

      <!-- Loading state -->
      @if (isLoading) {
      <div class="flex justify-center items-center h-64">
        <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"></div>
      </div>
      }

      <!-- Products grid -->
      @if (!isLoading && products.length > 0) {
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        <!-- Product card -->
        @for (product of products; track product.id) {
        <div class="bg-white rounded-lg overflow-hidden shadow-md transition-all duration-300 transform hover:-translate-y-1 cursor-pointer"
             (click)="navigateToProduct(product.id)">
          <div class="h-64 overflow-hidden relative">
            <!-- Loading skeleton -->
            @if (imageLoadingStates[product.id]) {
            <div class="absolute inset-0 bg-gray-200 animate-pulse flex items-center justify-center">
              <svg class="w-12 h-12 text-gray-300" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" viewBox="0 0 640 512">
                <path d="M480 80C480 35.82 515.8 0 560 0C604.2 0 640 35.82 640 80C640 124.2 604.2 160 560 160C515.8 160 480 124.2 480 80zM0 456.1C0 445.6 2.964 435.3 8.551 426.4L225.3 81.01C231.9 70.42 243.5 64 256 64C268.5 64 280.1 70.42 286.8 81.01L412.7 281.7L460.9 202.7C464.1 196.1 472.2 192 480 192C487.8 192 495 196.1 499.1 202.7L631.1 419.1C636.9 428.6 640 439.7 640 450.9C640 484.6 612.6 512 578.9 512H55.91C25.03 512 .0006 486.1 .0006 456.1L0 456.1z"/>
              </svg>
            </div>
            }
            
            <!-- Product image -->
            <img
              [src]="product.media_urls[1] "
              [alt]="product.name"
              class="w-full h-64 object-cover"
              (load)="handleImageLoad(product.id)"
              (error)="handleImageError($event, product.id)"
              [class.hidden]="imageLoadingStates[product.id] || imageErrors[product.id]"
            />
            
            <!-- Error state - show placeholder -->
            @if (imageErrors[product.id]) {
            <div class="absolute inset-0 bg-gray-100 flex items-center justify-center">
              <div class="text-center p-4">
                <svg class="w-12 h-12 text-gray-400 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
                <p class="text-gray-500 mt-2">تعذر تحميل الصورة</p>
              </div>
            </div>
            }
          </div>
          <div class="p-6">
            <h3 class="text-xl font-semibold text-blue-700 mb-2">{{ product.name }}</h3>
            <p class="text-gray-600 mb-4">{{ truncateDescription(product.description) || 'لا يوجد وصف' }}</p>
            <div class="flex justify-between items-center">
              <span class="text-lg font-bold text-blue-600">{{ product.price }} دينار</span>
              @if (product.originalPrice && product.originalPrice > product.price) {
              <div class="flex flex-col">
                <span class="text-sm text-gray-500 line-through">{{ product.originalPrice }} دينار</span>
                <span class="text-sm text-red-600 font-semibold">
                  وفر {{ calculateDiscount(product.originalPrice, product.price) }}%
                </span>
              </div>
              }
            </div>
            <div class="mt-4">
              <button
                class="w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-all"
                (click)="$event.stopPropagation(); addToCart(product)"
              >
                أضف إلى السلة
              </button>
            </div>
          </div>
        </div>
        }
      </div>
      }

      <!-- No products message -->
      @if (!isLoading && products.length === 0) {
      <div class="text-center py-12">
        <i class="fas fa-box-open text-5xl text-gray-400 mb-4"></i>
        <p class="text-xl text-gray-600">لا توجد منتجات متاحة حالياً</p>
      </div>
      }

      <!-- Pagination controls -->
      @if (totalPages >= 1 && !isLoading) {
      <div id="pagination" class="flex justify-center mt-12 space-x-2 space-x-reverse">
        <button
          (click)="previousPage()"
          [disabled]="currentPage === 1"
          id="prev-btn"
          class="px-4 py-2 bg-blue-600 text-white rounded disabled:bg-gray-300 disabled:cursor-not-allowed"
        >
          السابق
        </button>

        <div class="flex space-x-1 space-x-reverse" id="page-buttons">
          <div class="flex space-x-1 space-x-reverse">
            @for (page of getPagesArray(); track $index; let i = $index) {
            <button
              (click)="goToPage(i + 1)"
              [class.bg-blue-600]="currentPage === i + 1"
              [class.text-white]="currentPage === i + 1"
              [class.bg-gray-200]="currentPage !== i + 1"
              class="px-4 py-2 rounded"
            >
              {{ i + 1 }}
            </button>
            }
          </div>
        </div>

        <button
          (click)="nextPage()"
          [disabled]="currentPage === totalPages"
          id="next-btn"
          class="px-4 py-2 bg-blue-600 text-white rounded disabled:bg-gray-300 disabled:cursor-not-allowed"
        >
          التالي
        </button>
      </div>
      }

      <!-- Page info -->
      @if (totalItems > 0 && !isLoading) {
      <div class="text-center mt-4 text-gray-600">
        عرض {{ getStartIndex() }} - {{ getEndIndex() }} من أصل {{ totalItems }} منتج
      </div>
      }
    </div>

    <div class="text-center mt-12">
      <button
        (click)="showAllProducts()"
        class="inline-block border border-blue-600 text-blue-600 px-6 py-3 rounded-md hover:bg-blue-600 hover:text-white transition-all"
      >
        عرض جميع المنتجات
      </button>
    </div>
  </div>
</section>

<!-- Enhanced Footer -->
<footer class="text-white bg-primary">
  <!-- Newsletter Section -->
  <div class="bg-primary-dark py-8">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-6 md:mb-0 text-center md:text-right">
          <h3 class="text-xl font-bold heading-font mb-2">اشترك في نشرتنا الإخبارية</h3>
          <p class="text-gray-300">كن أول من يعرف عن العروض والمنتجات الجديدة</p>
        </div>
        <div class="w-full md:w-1/2 lg:w-1/3">
          <form class="flex flex-col sm:flex-row gap-2">
            <input
              type="email"
              placeholder="بريدك الإلكتروني"
              class="flex-grow px-4 py-3 rounded-lg newsletter-input text-gray-800"
            />
            <button
              class="bg-accent px-6 py-3 rounded-lg font-medium hover:bg-opacity-90 transition-all"
            >
              اشتراك
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Footer Content -->
  <div class="container mx-auto px-4 py-12">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8">
      <!-- Brand Column -->
      <div class="lg:col-span-2">
        <h3 class="text-2xl font-bold heading-font mb-4" (click)="scrollToTop()">Promomag</h3>
        <p class="text-gray-300 mb-6">
          نصمم مساحات جميلة بأثاث يحكي قصتك. نحن نؤمن بأن منزلك هو انعكاس لشخصيتك.
        </p>

        <div class="flex space-x-4 space-x-reverse mb-6">
          <a
            class="social-icon bg-white bg-opacity-10 w-10 h-10 rounded-full flex items-center justify-center"
          >
            <i class="fab fa-facebook-f text-accent"></i>
          </a>
          <a
            class="social-icon bg-white bg-opacity-10 w-10 h-10 rounded-full flex items-center justify-center"
          >
            <i class="fab fa-instagram text-accent"></i>
          </a>
          <a
            class="social-icon bg-white bg-opacity-10 w-10 h-10 rounded-full flex items-center justify-center"
          >
            <i class="fab fa-twitter text-accent"></i>
          </a>
          <a
            class="social-icon bg-white bg-opacity-10 w-10 h-10 rounded-full flex items-center justify-center"
          >
            <i class="fab fa-pinterest-p text-accent"></i>
          </a>
        </div>
      </div>

      <!-- Quick Links -->
      <div>
        <h4 class="text-lg font-semibold mb-4 border-b border-gray-700 pb-2">روابط سريعة</h4>
        <ul class="space-y-3">
          <li>
            <a
              (click)="scrollToTop()"
              class="text-gray-300 hover:text-white transition-all flex items-center"
            >
              <i class="fas fa-chevron-left text-xs ml-2 text-accent"></i>
              الرئيسية
            </a>
          </li>
          <li>
            <a class="text-gray-300 hover:text-white transition-all flex items-center">
              <i class="fas fa-chevron-left text-xs ml-2 text-accent"></i>
              المتجر
            </a>
          </li>
          <li>
            <a class="text-gray-300 hover:text-white transition-all flex items-center">
              <i class="fas fa-chevron-left text-xs ml-2 text-accent"></i>
              من نحن
            </a>
          </li>
          <li>
            <a class="text-gray-300 hover:text-white transition-all flex items-center">
              <i class="fas fa-chevron-left text-xs ml-2 text-accent"></i>
              اتصل بنا
            </a>
          </li>
        </ul>
      </div>

      <!-- Customer Service -->
      <div>
        <h4 class="text-lg font-semibold mb-4 border-b border-gray-700 pb-2">خدمة العملاء</h4>
        <ul class="space-y-3">
          <li>
            <a class="text-gray-300 hover:text-white transition-all flex items-center">
              <i class="fas fa-chevron-left text-xs ml-2 text-accent"></i>
              الأسئلة الشائعة
            </a>
          </li>
          <li>
            <a class="text-gray-300 hover:text-white transition-all flex items-center">
              <i class="fas fa-chevron-left text-xs ml-2 text-accent"></i>
              الإرجاع والاستبدال
            </a>
          </li>
          <li>
            <a class="text-gray-300 hover:text-white transition-all flex items-center">
              <i class="fas fa-chevron-left text-xs ml-2 text-accent"></i>
              سياسة الشحن
            </a>
          </li>
          <li>
            <a class="text-gray-300 hover:text-white transition-all flex items-center">
              <i class="fas fa-chevron-left text-xs ml-2 text-accent"></i>
              سياسة الخصوصية
            </a>
          </li>
        </ul>
      </div>

      <!-- Contact Info -->
      <div>
        <h4 class="text-lg font-semibold mb-4 border-b border-gray-700 pb-2">تواصل معنا</h4>
        <address class="text-gray-300 not-italic">
          <div class="flex items-start mb-3">
            <i class="fas fa-map-marker-alt text-accent mt-1 ml-3"></i>
            <p>123 شارع الأثاث، مدينة التصميم، DC 12345</p>
          </div>
          <div class="flex items-center mb-3">
            <i class="fas fa-envelope text-accent ml-3"></i>
            <a href="mailto:info@lockbor.com" class="hover:text-white">info@lockbor.com</a>
          </div>
          <div class="flex items-center mb-3">
            <i class="fas fa-phone text-accent ml-3"></i>
            <a href="tel:1234567890" class="hover:text-white">(123) 456-7890</a>
          </div>
          <div class="flex items-center">
            <i class="fas fa-clock text-accent ml-3"></i>
            <p>أيام العمل: من الأحد إلى الخميس<br />9 صباحاً - 5 مساءً</p>
          </div>
        </address>
      </div>
    </div>
  </div>

  <!-- Footer Bottom -->
  <div class="bg-primary-dark py-6">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-4 md:mb-0 text-center md:text-right">
          <p class="text-gray-400">&copy; 2023 . جميع الحقوق محفوظة.</p>
        </div>

        <div class="flex flex-wrap justify-center gap-4 mb-4 md:mb-0">
          <img
            src="https://cdn-icons-png.flaticon.com/512/196/196578.png"
            alt="Visa"
            class="payment-method h-8"
          />
          <img
            src="https://cdn-icons-png.flaticon.com/512/196/196561.png"
            alt="Mastercard"
            class="payment-method h-8"
          />
          <img
            src="https://cdn-icons-png.flaticon.com/512/196/196558.png"
            alt="PayPal"
            class="payment-method h-8"
          />
          <img
            src="https://cdn-icons-png.flaticon.com/512/196/196565.png"
            alt="Apple Pay"
            class="payment-method h-8"
          />
          <img
            src="https://cdn-icons-png.flaticon.com/512/196/196554.png"
            alt="Mada"
            class="payment-method h-8"
          />
        </div>

        <div class="text-center md:text-left">
          <a class="text-gray-400 hover:text-white text-sm transition-all">شروط الخدمة</a>
          <span class="text-gray-600 mx-2">|</span>
          <a class="text-gray-400 hover:text-white text-sm transition-all">سياسة الخصوصية</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Back to Top Button -->
  <button
    id="backToTop"
    class="fixed bottom-6 left-6 bg-accent w-12 h-12 rounded-full flex items-center justify-center shadow-lg opacity-0 transition-opacity"
  >
    <i class="fas fa-arrow-up text-white"></i>
  </button>
</footer>
